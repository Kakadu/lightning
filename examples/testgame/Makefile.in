
MLPPOPT = $(LIGHTNING_PATH)/syntax/pa_prop.cmo $(LIGHTNING_PATH)/syntax/pa_debug.cmo -enable-debug default
#Code/test_game.cmx: MLFLAGS += -I lightning/src/gl/2.1

CFLAGS += -I Code -I $(LIGHTNING_PATH)
MLFLAGS += -I $(LIGHTNING_PATH) -package extlib

#Code/TLF.cmx: Code/Light.cmx
#Code/TLF.cmx: MLFLAGS += -package xmlm
#Code/test_game.cmx: Code/TLF.cmx
Code/test_game.cmx: Code/Light.cmx
Code/test_game.cmx: MLFLAGS += -I Code

test: $(MOBS) Code/test_game.cmx
	$(OCAMLOPT) -verbose -o lighttest -g  \
	-I $(LIGHTNING_PATH) $(LIGHTNING_PATH)/lightning.cmxa  -I Code Light.cmx \
	$(MOBS) Code/test_game.cmx -package bigarray,extlib,xmlm,dbm $(TESTFLAGS) -linkpkg 


farm: MLFLAGS += -I Code
Code/Farm.cmx Code/ResourceProxy.cmx: Code/Light.cmx
Code/Farm.cmx: Code/ResourceProxy.cmx

farm: $(MOBS) Code/Farm.cmx
	$(OCAMLOPT) -verbose -o farm -g \
	-I $(LIGHTNING_PATH) $(LIGHTNING_PATH)/lightning.cmxa \
	$(MOBS) Code/Farm.cmx -package bigarray,extlib,xmlm -linkpkg 

Code/Hamsters: 
	$(MAKE) -C Code/Hamsters

hamsters: $(MOBS) Code/Hamsters
	$(OCAMLOPT) -o hamsters -g -I lightning/src $(LIGHTNING_PATH)/lightning.cmxa $(LINKFLAGS) Code/Hamsters/Hamsters.cmx -package bigarray,extlib,xmlm  $(MOBS) -linkpkg

build: hamsters

.PHONY: lightning

lightning:
	$(MAKE) -C lightning


depend:: 

.DEFAULT_GOAL := test

.PHONY: clean Code/Hamsters
